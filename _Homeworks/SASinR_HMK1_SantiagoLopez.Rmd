---
title: "R.Camp - Homework 1"
author: "Santiago López Álvarez"
output: pdf_document
---
```{r}
library(xtable)
library(stargazer)
```
Homework 1 
-------------
-------------

**Problem 1**
-------------

**Theoretical question:**

In this project, I am primarily interested in exploring the levels of domestic violence (national) and its relationship to the state of the economy, and the strengh of the democracy (if it applies).  

Conventional wisdom indicates that a good and healthy economy plus strong democratic institutions should lead to more stable and peaceful states. When the national economy thrives, it is expected to produce more jobs, increase or at least maintain purchase power, and incentivize the consumption of goods and services. In addition to attractive economic figures, states require strong and reliable institutions to run the administrative functions of the country. In the vast majority of the developed world, the democratic system is considered to be the most appropriate form of government to perform this task.

Economy and democracy are then seen as two critical elements for national stability, and although these goals seem to be clear for the governments, the strength and rate at which they develop vary from case to case. These national differences, however, do not prevent researchers from assesing the social stability stage of a country (understood here as low levels of violence), as a function of its economic and democractic development process. On the contrary, these differences should in fact serve as evidence to suppport or deny the conventional wisdom claim, according to which we should  expect nations with better economies and stronger democractic institutions to display lower rates of domestic violence than countries with lower performances. 

**Data**

To explore the impact of democracy and economy on the levels of domestic violence, I generated a data set of 167 observations.The unit of analysis are countries. 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

(Reading the dataset)
```{r}
fdataset <- read.csv("R-camp final dataset.csv")
```

**Variables**
-------------

**Dependent variable:**
**Levels of domestic violence:** measured as the number of murders per 100,000 citizens. 

Descriptive statistics:

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
        output <- capture.output(stargazer(...))
        output <- output[4:length(output)]
       cat(paste(output, collapse = "\n"),"\n")
}
a <- data.frame(fdataset$homicideRate)
mod_stargazer(a, title="Homicide Rates")
```

Histogram
```{r}
hist(fdataset$homicideRate, xlab="Number of Murders per 100,000 citizens", ylab="Frequency", xlim=c(0, 100), main="Homicide Rate")
```


**Main independent variables:**

**Economic performance:** measured by the GDP per capita index.

Descriptive statistics:

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
        output <- capture.output(stargazer(...))
        output <- output[4:length(output)]
       cat(paste(output, collapse = "\n"),"\n")
}
b <- data.frame(fdataset$X2018.GDP.per.capita..current.US..)
mod_stargazer(b, title="GDP per Capita")
```

Histogram

```{r}
hist(fdataset$X2018.GDP.per.capita..current.US.., xlab="GDP per capita", ylab="Frequency", main="Economic Performance") 
```
        
**Democracy strength:** measured by the Polity IV score. 

Descriptive statistics:

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
        output <- capture.output(stargazer(...))
        output <- output[4:length(output)]
       cat(paste(output, collapse = "\n"),"\n")
}
c <- data.frame(fdataset$polity.IV)
mod_stargazer(c, title="Democracy Score")
```

Histogram

```{r} 
hist(fdataset$polity.IV, breaks=20, xlab="Polity IV Score", ylab="Frequency", main="Democracy Strenght") 
```

**Control variables:**

**National income:** measured categorically by the World Bank.

Descriptive statistics:

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
        output <- capture.output(stargazer(...))
        output <- output[4:length(output)]
       cat(paste(output, collapse = "\n"),"\n")
}
d <- data.frame(fdataset$IncomeGroup)
mod_stargazer(d, title="Income Groups")
```

Histogram
```{r}
plot(fdataset$IncomeGroup, ylim=c(0,50), main="Income Groups")
```

**Corruption level:** measured by the CPI (Corruption Perceptions Index).

Descriptive statistics:

```{r}
corrupt <- read.csv("Corruption.csv")
# mod_stargazer(corrupt)
```

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
        output <- capture.output(stargazer(...))
        output <- output[4:length(output)]
       cat(paste(output, collapse = "\n"),"\n")
}
e <- data.frame(fdataset$CPI.Score.2018)
mod_stargazer(e, title="Corruption Perceptions Index")
```

Histogram
```{r}
hist(fdataset$CPI.Score.2018, xlab="Corruption Score", ylab="Frequency", main="Corruption Levels", xlim=c(0,100)) 
```

**Problem 2**
-------------

Since I am interested in the relationship between violence and the economy and democratic stages of the country, a scatter plot of the relationship between the variables seems appropriate. The plot presented below shows how the levels of violence in the countries in our data change at different levels of GDP. Higher values on GDP indicate a wealthier country, whereas high indices on the y axis shows a larger amount of murders. 

**Scatter plot 1 (Economy vs Homicide Rate)**
Exploring visually whether there is a linear relationship between violence and economy. Different colours indicate the six different regions in which the countries are divided:

```{r, echo=FALSE}
plot(fdataset$X2018.GDP.per.capita..current.US../1000, fdataset$homicideRate, ylab= "Homicide Rate", xlab= "GDP per capita", ylim=c(0,100), col=fdataset$Region.x, main = "Impact of Economy on Homicide Rates")
legend("topright", legend=c("AME", "AP", "ECA", "MENA", "SSA", "WE/EU"),            
        col=c("navy", "firebrick", "red", "yellow", "blue", "green"), lty=c(2,2)) 
```

As the plot indicates, the relationship looks exponential rather than linear. That said, once can clearly see a pattern in which higher values of murder rates are concentrated in the countries with the lowest GDP rates. 

**Regression Model**

As stated above, the graph displays an exponential relationship rather than linear. However, for the sake of this activity, I will fit a linear model. The regression below measures the impact of the economy on the  homicides rate. The convenional argument indicates that a healthier and stronger economy should contribute to reduce the levels of domestic violence; therefore we should expect a negative coefficient as a result. In other words, as the economy increases, the rate of homicides should decrease.  

Code for the model fit:
```{r}
fregr <- lm(X2018.GDP.per.capita..current.US..~ homicideRate, data = fdataset)
```

Regression table:

```{r, results='asis', message=FALSE}
library("stargazer")

mod_stargazer <- function(...){
  output <- capture.output(stargazer(...))
  output <- output[4:length(output)]
  cat(paste(output, collapse = "\n"), "\n")
}

mod_stargazer(fregr, type="latex",
          omit.table.layout="n", 
          digits=2, 
          digits.extra=0, 
          title="Impact of GDP on Murder Rate")
```

