---
title: "HW2"
author: "Rabia Suleiman"
date: "8/22/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, eval=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question
There are many variables that can differences in life expectancy like sex, location (urban/rural, major regions/provinces) and socio-economic characteristics (e.g. education, wealth quintile). Average life expectancy varies by state in the United States. This question seeks to determine the impact of healthcare spending per capita of each state on the life expectancy of individuals residing there. We expect that the more the state invest in healthcare, the greater the life expectancy (As access to healthcare provides preventative care as education programs.) We also control for socioeconomic status and ses. 




__Health Care Investemnt__
State level= health care by state follows a normal distribution with the majority of states allocating between $6350 and $7700 per year, (9 states allocated less while 8 allocated more) 

Unit of Analysis = 5000 Individuals in the United States

```{r, N}
rm(list=ls())
 N = 50
health<-rnorm(n=N, mean=70, sd=2)
hist((health), xlab= "funding per capita (per hundred)", ylab= "State Frequency", main="Healthcare funding variable distribution")  
summary (health)
```

__Gender__

The sex of an indivudal plays a significant role in life expectancy. A binomial distribution with.5 probability was used to assign gender. 
```{r pressure, echo=TRUE}
sex=rbinom(n=N, size=1, prob=0.5) #1 is female, 0 is male 
summary(sex)
```

__Socioeconomic Status__

The average American is $56,000, we allow for a normal distribution (although this a hypothetical situaltion in reality the distrubtion is somewhat skewed to the poor but its not quite an exponential distribution)
```{r}
ses2<-rnorm(n=N, mean=560, sd=5)
hist((ses2), xlab= "Individual Income (per hundred)", ylab= " Frequency", main="SocioEconomic Variable Distribution")  
summary (ses2)
mean_ses<-560
```

__life expectancy__

```{r}
 a = 48
 b1 = 0.35
 b2 = 0.35
 b3 = 0.025
 error = rnorm(n=N, mean=0, sd=0.1) # N(0,1)
 expectancy<-a+ b1*health + b2*sex+ b3*ses2 +error
 hist((expectancy) , xlab= "years", ylab= "Frequency", main="Life Expectancy Histogram")  
```


```{r}
regression1 <- lm(expectancy ~ health + sex+ ses2)
summary(regression1)
```


```{r, ECHO=FALSE}
health_c<- seq(from=1, to=100, by=1)

Pred_exp<- NA

for(i in 1:100){
Pred_exp[i] = 47.44 + (0.35*health_c[i]) + (0.351*1) + (.026*mean_ses)

}
```

```{r}
 head(Pred_exp)
 hist(Pred_exp)
 summary(Pred_exp)
 
plot((Pred_exp ~ health_c),  xlab="State Funding", ylab="life expectancy",
main="State Health Expenditure")
abline(v=mean(health), col="red", lwd=2)
```

